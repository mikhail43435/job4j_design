-- Написать запрос получение всех продуктов с типом "СЫР"
SELECT * FROM type t JOIN product p ON t.id=p.type_id WHERE t.name ILIKE '%сыр%';
SELECT * FROM type t JOIN product p ON t.id=p.type_id WHERE t.id=2;

-- Написать запрос получения всех продуктов, у кого в имени есть слово "мороженное"
SELECT * FROM product p WHERE p.name ILIKE '%мороженное%';

-- Написать запрос, который выводит все продукты, срок годности которых заканчивается в следующем месяце
SELECT * FROM product p 
WHERE p.expired_date >= (DATE_TRUNC('MONTH', CURRENT_DATE) + INTERVAL '1 MONTH - 1 day') 
AND p.expired_date <= (DATE_TRUNC('MONTH', CURRENT_DATE) + INTERVAL '2 MONTH - 1 day');

-- Написать запрос, который выводит самый дорогой продукт
SELECT * FROM product p WHERE p.price = (SELECT MAX(product.price) FROM product);

-- Написать запрос, который выводит количество всех продуктов определенного типа.
SELECT COUNT(*) FROM product p JOIN type t ON p.type_id=t.id WHERE t.id=1;

-- Написать запрос получение всех продуктов с типом "СЫР" и "МОЛОКО"
SELECT COUNT(*) FROM product p JOIN type t ON p.type_id=t.id WHERE t.id=1 OR t.id=2;

-- Написать запрос, который выводит тип продуктов, которых осталось меньше 3 штук.
SELECT t.name, COUNT(p.name) AS count FROM product p 
JOIN type AS t ON p.type_id=t.id 
GROUP BY t.name HAVING COUNT(p.name)<=3;

-- Вывести все продукты и их тип.
SELECT * FROM product p JOIN type AS t ON p.type_id=t.id;